<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8"><title>Master Admin</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.ckeditor.com/4.19.1/standard/ckeditor.js"></script>
    <style>
        body { font-family: sans-serif; display: flex; margin: 0; background: #f4f7f6; }
        .sidebar { width: 250px; background: #2c3e50; color: white; height: 100vh; position: fixed; padding: 20px; }
        .main { margin-left: 270px; padding: 30px; width: 100%; }
        .card { background: white; padding: 20px; border-radius: 10px; margin-bottom: 20px; border-top: 4px solid #3498db; }
        input, select, textarea { width: 100%; padding: 10px; margin: 10px 0; border-radius: 5px; border: 1px solid #ddd; }
        .btn { padding: 10px 20px; cursor: pointer; border: none; border-radius: 5px; color: white; font-weight: bold; }
        .btn-blue { background: #3498db; } .btn-green { background: #27ae60; } .btn-orange { background: #e67e22; }
    </style>
</head>
<body>
<div class="sidebar">
    <h2>Cognito Admin</h2>
    <a href="#structure" style="color:white;display:block;margin:10px 0;">Structure</a>
    <a href="#material" style="color:white;display:block;margin:10px 0;">Material & AI</a>
    <a href="#quiz" style="color:white;display:block;margin:10px 0;">Quiz Builder</a>
    <a href="#video" style="color:white;display:block;margin:10px 0;">Video Lectures</a>
</div>

<div class="main">
    <h1>Final Control Panel</h1>

    <div id="structure" class="card">
        <h3>1. Subject & Topic Manager</h3>
        <form method="POST"><input type="text" name="cat_name" placeholder="New Subject"><button class="btn btn-green">Add Subject</button></form>
        <form method="POST">
            <select name="parent_id">{% for c in categories %}<option value="{{c.id}}">{{c.name}}</option>{% endfor %}</select>
            <input type="text" name="subcat_name" placeholder="New Topic"><button class="btn btn-green">Add Topic</button>
        </form>
    </div>

    <div id="material" class="card">
        <h3>2. AI Notes Generator</h3>
        <input type="text" id="ai_topic" placeholder="Enter Topic Name">
        <button onclick="askAI()" class="btn btn-orange">AI se Likhein</button>
        <form method="POST">
            <input type="text" name="post_title" id="p_title" placeholder="Title">
            <select name="p_sub_id">{% for s in subcategories %}<option value="{{s.id}}">{{s.name}}</option>{% endfor %}</select>
            <textarea name="post_content" id="editor_post"></textarea>
            <button class="btn btn-blue">Publish Post</button>
        </form>
    </div>

    <div id="quiz" class="card">
        <h3>3. Professional Quiz Builder</h3>
        <form method="POST">
            <input type="text" name="quiz_topic" placeholder="Quiz Topic Name">
            <textarea name="quiz_desc" placeholder="Instructions..."></textarea>
            <select name="sub_id">{% for s in subcategories %}<option value="{{s.id}}">{{s.name}}</option>{% endfor %}</select>
            <div style="display:flex;gap:10px;"><input type="number" name="time" placeholder="Time (Min)"><input type="number" step="0.01" name="neg" placeholder="Neg Marking"></div>
            <button class="btn btn-blue">Step 1: Create Quiz Header</button>
        </form>
        <hr>
        <h4>Add Questions with Editor</h4>
        <form method="POST">
            <select name="target_quiz">{% for q in quizzes %}<option value="{{q.id}}">{{q.topic}}</option>{% endfor %}</select>
            <textarea name="q_text" id="editor_q"></textarea>
            <input type="text" name="oa" placeholder="Option A"><input type="text" name="ob" placeholder="Option B">
            <input type="text" name="oc" placeholder="Option C"><input type="text" name="od" placeholder="Option D">
            <textarea name="exp" id="editor_exp"></textarea>
            <select name="ans"><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="D">D</option></select>
            <button class="btn btn-orange">Step 2: Save Question</button>
        </form>
    </div>

    <div id="video" class="card">
        <h3>4. Video Lecture Manager</h3>
        <form method="POST">
            <input type="text" name="video_title" placeholder="Video Title">
            <input type="text" name="video_url" placeholder="YouTube URL">
            <select name="v_sub_id">{% for s in subcategories %}<option value="{{s.id}}">{{s.name}}</option>{% endfor %}</select>
            <button class="btn btn-blue">Add Video</button>
        </form>
    </div>
</div>

<script>
    CKEDITOR.replace('editor_post');
    CKEDITOR.replace('editor_q');
    CKEDITOR.replace('editor_exp');

    async function askAI() {
        let topic = document.getElementById('ai_topic').value;
        const res = await fetch('/ai_action', {method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify({prompt: "Write UPSC notes on " + topic + " with HTML tags"})});
        const data = await res.json();
        CKEDITOR.instances.editor_post.setData(data.result);
    }
</script>
</body>
</html>
